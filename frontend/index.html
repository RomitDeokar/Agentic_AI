<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartTrip - Intelligent Travel Planning</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-gray-900 text-white">
    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 glass-card border-b border-purple-500/20">
        <div class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
                    <i class="fas fa-route text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                        SmartTrip
                    </h1>
                    <p class="text-xs text-gray-400">Intelligent Travel Planning</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <button onclick="startDemo()" class="btn-primary">
                    <i class="fas fa-play"></i>
                    <span>Demo Mode</span>
                </button>
                <button onclick="toggleTheme()" class="btn-icon">
                    <i class="fas fa-moon"></i>
                </button>
                <button onclick="toggleSettings()" class="btn-icon">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-layout pt-20">
        <!-- Left Sidebar -->
        <aside class="left-sidebar">
            <!-- Trip Planning Form -->
            <div class="glass-card p-6 mb-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-edit text-purple-400"></i>
                    Plan Your Trip
                </h3>
                
                <form id="tripForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Destination</label>
                        <input type="text" id="destination" 
                               class="input-field" 
                               placeholder="e.g., Rajasthan, India"
                               value="Rajasthan, India">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Duration</label>
                            <input type="number" id="duration" 
                                   class="input-field" 
                                   placeholder="Days" 
                                   value="3" 
                                   min="1">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Budget (‚Çπ)</label>
                            <input type="number" id="budget" 
                                   class="input-field" 
                                   placeholder="15000" 
                                   value="15000" 
                                   min="1000">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Travel Style</label>
                        <select id="persona" class="input-field">
                            <option value="solo">ü•æ Solo Backpacker</option>
                            <option value="family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</option>
                            <option value="luxury">üíé Luxury Traveler</option>
                            <option value="adventure">üèîÔ∏è Adventure Seeker</option>
                            <option value="cultural">üèõÔ∏è Cultural Explorer</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Start Date</label>
                        <input type="date" id="startDate" class="input-field">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-2">Preferences</label>
                        <div class="flex flex-wrap gap-2" id="preferenceTags">
                            <button type="button" class="tag active" data-pref="cultural">üèõÔ∏è Cultural</button>
                            <button type="button" class="tag active" data-pref="adventure">üèîÔ∏è Adventure</button>
                            <button type="button" class="tag" data-pref="relaxation">üßò Relaxation</button>
                            <button type="button" class="tag" data-pref="food">üçú Food</button>
                            <button type="button" class="tag" data-pref="nightlife">üåÉ Nightlife</button>
                            <button type="button" class="tag" data-pref="shopping">üõçÔ∏è Shopping</button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-primary w-full">
                        <i class="fas fa-magic"></i>
                        <span>Generate Itinerary</span>
                    </button>
                </form>
            </div>
            
            <!-- Budget Tracker -->
            <div class="glass-card p-6 mb-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-wallet text-green-400"></i>
                    Budget Tracker
                </h3>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-baseline">
                        <span class="text-3xl font-bold text-green-400" id="budgetUsed">‚Çπ5,400</span>
                        <span class="text-gray-400">/ <span id="budgetTotal">‚Çπ15,000</span></span>
                    </div>
                    
                    <div class="budget-bar">
                        <div class="budget-fill" id="budgetFill" style="width: 36%"></div>
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">üè® Accommodation</span>
                            <span id="budgetAccommodation">‚Çπ2,100</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">üçΩÔ∏è Food</span>
                            <span id="budgetFood">‚Çπ1,800</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">üöó Transport</span>
                            <span id="budgetTransport">‚Çπ1,000</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">üé´ Activities</span>
                            <span id="budgetActivities">‚Çπ500</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Preference Learning -->
            <div class="glass-card p-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-brain text-pink-400"></i>
                    AI Learning Progress
                </h3>
                
                <div class="space-y-3" id="preferencesBars">
                    <!-- Populated by JavaScript -->
                </div>
                
                <p class="text-xs text-gray-400 mt-4">
                    <i class="fas fa-info-circle"></i>
                    System learns from your ratings
                </p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Map Section -->
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-map-marked-alt text-blue-400"></i>
                        Interactive Route Map
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="toggleHeatmap()" class="btn-small">
                            <i class="fas fa-fire"></i>
                            Crowd Heatmap
                        </button>
                    </div>
                </div>
                
                <div class="map-container">
                    <div id="map" class="rounded-xl overflow-hidden" style="height: 400px;"></div>
                </div>
            </div>
            
            <!-- AI Agents Status -->
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-robot text-purple-400"></i>
                        AI Agents Activity
                    </h3>
                    <button onclick="toggleAgentsPanel()" class="btn-icon">
                        <i class="fas fa-chevron-down" id="agentsPanelToggle"></i>
                    </button>
                </div>
                
                <div id="agentsPanel" class="grid grid-cols-2 gap-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Itinerary Timeline -->
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-calendar-alt text-yellow-400"></i>
                        Your Itinerary
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="regenerateItinerary()" class="btn-small">
                            <i class="fas fa-sync"></i>
                            Regenerate
                        </button>
                        <button onclick="exportPDF()" class="btn-small">
                            <i class="fas fa-download"></i>
                            Export
                        </button>
                    </div>
                </div>
                
                <div id="itineraryTimeline" class="space-y-6">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Emergency Controls -->
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2 text-red-400">
                        <i class="fas fa-exclamation-triangle"></i>
                        Emergency Scenarios
                    </h3>
                    <button onclick="toggleEmergencyPanel()" class="btn-icon">
                        <i class="fas fa-chevron-down" id="emergencyPanelToggle"></i>
                    </button>
                </div>
                
                <div id="emergencyPanel" class="grid grid-cols-2 gap-3">
                    <button onclick="triggerRainstorm()" class="btn-emergency">
                        <i class="fas fa-cloud-rain"></i>
                        Rainstorm
                    </button>
                    <button onclick="triggerBudgetChange()" class="btn-emergency">
                        <i class="fas fa-dollar-sign"></i>
                        Budget Alert
                    </button>
                    <button onclick="triggerCrowdSurge()" class="btn-emergency">
                        <i class="fas fa-users"></i>
                        Crowd Surge
                    </button>
                    <button onclick="triggerClosedVenue()" class="btn-emergency">
                        <i class="fas fa-times-circle"></i>
                        Venue Closed
                    </button>
                </div>
            </div>
            
            <!-- Multi-Agent Communication Graph -->
            <div class="glass-card p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-network-wired text-cyan-400"></i>
                        Agent Communication
                    </h3>
                    <button onclick="toggleCommGraph()" class="btn-icon">
                        <i class="fas fa-chevron-down" id="commGraphToggle"></i>
                    </button>
                </div>
                
                <div id="commGraphPanel">
                    <div id="agentCommGraph" style="height: 400px;"></div>
                </div>
            </div>
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <!-- RL Reward Progress -->
            <div class="glass-card p-6 mb-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-line text-green-400"></i>
                    Learning Progress
                </h3>
                
                <div style="height: 200px;">
                    <canvas id="rewardChart"></canvas>
                </div>
                
                <div class="mt-4 text-xs space-y-1">
                    <div class="flex justify-between">
                        <span class="text-gray-400">Episodes:</span>
                        <span id="rlEpisodes">0</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Avg Reward:</span>
                        <span id="rlAvgReward">0.00</span>
                    </div>
                </div>
            </div>
            
            <!-- MDP Visualization -->
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-project-diagram text-blue-400"></i>
                        MDP States
                    </h3>
                    <button onclick="toggleMDPSettings()" class="btn-icon">
                        <i class="fas fa-sliders-h"></i>
                    </button>
                </div>
                
                <div id="mdpSettingsPanel" class="hidden mb-4 space-y-2">
                    <div>
                        <label class="text-xs text-gray-400">Exploration (Œ±)</label>
                        <input type="range" id="mdpAlpha" min="0" max="1" step="0.1" value="0.4" 
                               class="w-full" onchange="updateMDPParams()">
                        <span id="mdpAlphaValue" class="text-xs">0.4</span>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Budget Weight (Œ≤)</label>
                        <input type="range" id="mdpBeta" min="0" max="1" step="0.1" value="0.3" 
                               class="w-full" onchange="updateMDPParams()">
                        <span id="mdpBetaValue" class="text-xs">0.3</span>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Weather Weight (Œ≥)</label>
                        <input type="range" id="mdpGamma" min="0" max="1" step="0.1" value="0.2" 
                               class="w-full" onchange="updateMDPParams()">
                        <span id="mdpGammaValue" class="text-xs">0.2</span>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Crowd Penalty (Œ¥)</label>
                        <input type="range" id="mdpDelta" min="0" max="1" step="0.1" value="0.1" 
                               class="w-full" onchange="updateMDPParams()">
                        <span id="mdpDeltaValue" class="text-xs">0.1</span>
                    </div>
                </div>
                
                <div style="height: 200px;">
                    <canvas id="mdpCanvas"></canvas>
                </div>
            </div>
            
            <!-- Weather Forecast -->
            <div class="glass-card p-6 mb-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-cloud-sun text-yellow-400"></i>
                    Weather Forecast
                </h3>
                
                <div id="weatherCards" class="space-y-3">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            
            <!-- Crowd Analysis -->
            <div class="glass-card p-6">
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fas fa-fire text-orange-400"></i>
                    Crowd Levels
                </h3>
                
                <div id="crowdData" class="space-y-2">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </aside>
    </div>

    <!-- Real-Time Logs Panel (Bottom) -->
    <div class="fixed bottom-0 left-0 right-0 z-40 glass-card border-t border-purple-500/20">
        <div class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center mb-2">
                <h4 class="text-sm font-bold flex items-center gap-2">
                    <i class="fas fa-terminal text-gray-400"></i>
                    System Activity
                </h4>
                <button onclick="toggleLogsPanel()" class="btn-icon text-xs">
                    <i class="fas fa-chevron-up" id="logsPanelToggle"></i>
                </button>
            </div>
            
            <div id="logsPanel" class="max-h-32 overflow-y-auto">
                <div id="logContainer" class="space-y-1 text-xs font-mono">
                    <!-- Logs populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="fixed top-20 right-6 z-50 space-y-2"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <div class="text-center">
            <div class="loader mb-4"></div>
            <p id="loadingText" class="text-lg">Processing...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/agents.js"></script>
    <script src="js/mdp.js"></script>
    <script src="js/bayesian.js"></script>
    <script src="js/rl.js"></script>
    <script src="js/map.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/demo.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
